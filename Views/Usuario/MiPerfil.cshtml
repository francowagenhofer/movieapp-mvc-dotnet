@model MiPerfilViewModel

@{
    string mensaje = ViewData["Mensaje"] as string ?? "";
}

<main class="flex-grow-1 d-flex align-items-center justify-content-center py-5">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-8 col-lg-6">
                <div class="card app-auth-card p-4 p-md-5 rounded-3">
                    <form method="post" enctype="multipart/form-data">
                        <div class="text-center mb-4">
                            <div class="profile-img-container mb-3">
                                <img alt="Foto de perfil" id="profileImage" class="profile-avatar" src="@Model.ImagenUrlPerfil" />
                                <button type="button" class="profile-edit-btn" onclick="document.getElementById('ImagenPerfil').click()">
                                    <span class="material-symbols-outlined">edit</span>
                                </button>
                                <input type="file" asp-for="ImagenPerfil" accept="image/png,image/jpeg,image/webp" class="form-control d-none" onchange="previewImage(this)" id="ImagenPerfil" />
                            </div>
                            <h2 class="h4 fw-bold mb-1">@Model.Nombre @Model.Apellido</h2>
                            <p class="text-secondary">@Model.Email</p>
                        </div>
                        <div class="mb-3">
                            <label class="form-label" for="name">Nombre</label>
                            <input asp-for="Nombre" class="form-control form-control-lg" placeholder="Sophia" />
                        </div>
                        <div class="mb-3">
                            <label class="form-label" for="apellido">Apellido</label>
                            <input asp-for="Apellido" class="form-control form-control-lg" placeholder="Clark" />
                        </div>
                        <div class="mb-4">
                            <label class="form-label" for="email">Correo electrónico</label>
                            <input asp-for="Email" class="form-control form-control-lg" disabled placeholder="sophia.clark@email.com" />
                        </div>
                        <button class="app-btn app-btn-primary w-100 btn-lg fw-semibold" type="submit">Guardar cambios</button>
                    </form>

                    @if (!string.IsNullOrEmpty(mensaje))
                    {
                        <div class="alert alert-success alert-dismissible fade show mt-3" role="alert">
                            @mensaje
                            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</main>

<script>
    function previewImage(input) {
        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = function (e) {
                document.getElementById('profileImage').src = e.target.result;
            };
            reader.readAsDataURL(input.files[0]);
        }
    }
</script>